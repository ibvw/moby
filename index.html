<!DOCTYPE html>

<html lang="de">
<head>
<meta charset="UTF-8">
<title>Moby Wecker</title>
<style>
body { background: #121212; color: white; font-family: sans-serif; text-align: center; padding: 20px; }
#digitalClock { font-size: 3.5rem; color: #03dac6; margin-bottom: 20px; font-weight: bold; }
.card { background: #1e1e1e; padding: 20px; border-radius: 15px; display: inline-block; width: 90%; max-width: 400px; box-shadow: 0 10px 20px rgba(0,0,0,0.5); }
input { padding: 10px; margin: 10px 0; width: 85%; border-radius: 5px; border: 1px solid #333; background: #2c2c2c; color: white; }
.days { display: flex; justify-content: space-around; margin: 15px 0; }
.day { font-size: 0.7rem; display: flex; flex-direction: column; }
button { padding: 10px; margin: 5px; cursor: pointer; border-radius: 5px; border: none; font-weight: bold; width: 45%; }
.btn-s { background: #03dac6; } .btn-l { background: #bb86fc; }
#alarmList { list-style: none; padding: 0; margin-top: 30px; }
.item { background: #2c2c2c; padding: 10px; margin: 5px auto; max-width: 380px; display: flex; justify-content: space-between; border-left: 4px solid #03dac6; border-radius: 5px; }
</style>
</head>
<body>

<div id="digitalClock">00:00:00</div>

<div class="card">
<input type="text" id="aTitle" placeholder="Name">
<input type="time" id="aTime">
<div class="days">
<div class="day">Mo<input type="checkbox" class="d" value="1"></div>
<div class="day">Di<input type="checkbox" class="d" value="2"></div>
<div class="day">Mi<input type="checkbox" class="d" value="3"></div>
<div class="day">Do<input type="checkbox" class="d" value="4"></div>
<div class="day">Fr<input type="checkbox" class="d" value="5"></div>
<div class="day">Sa<input type="checkbox" class="d" value="6"></div>
<div class="day">So<input type="checkbox" class="d" value="0"></div>
</div>
<button class="btn-s" onclick="add()">Speichern</button>
<button class="btn-l" onclick="link()">Teilen</button>
</div>

<ul id="alarmList"></ul>

<script>
/* Alles in einfachem Stil ohne Sonderzeichen */
var alarms = JSON.parse(localStorage.getItem('myAlarms')) || [];
var days = ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"];

function runClock() {
var el = document.getElementById('digitalClock');
if(el) {
var jetzt = new Date();
el.textContent = jetzt.toLocaleTimeString('de-DE');
}
}

function show() {
var list = document.getElementById('alarmList');
if(!list) return;
list.innerHTML = "";

alarms.forEach(function(a, i) {
    var dStr = &quot;&quot;;
    if (a.d) { 
        dStr = a.d.map(function(x){ return days[x]; }).join(&quot;,&quot;); 
    }
    
    var li = document.createElement(&#39;li&#39;);
    li.className = &#39;item&#39;;
    li.innerHTML = &#39;&lt;div style=&quot;text-align:left&quot;&gt;&lt;b&gt;&#39; + a.t + &#39; Uhr&lt;/b&gt; - &#39; + a.n + &#39;<br>&lt;small&gt;&#39; + dStr + &#39;&lt;/small&gt;&lt;/div&gt;&#39; +
                   &#39;&lt;button onclick=&quot;del(&#39; + i + &#39;)&quot; style=&quot;width:auto;background:red;color:white&quot;&gt;X&lt;/button&gt;&#39;;
    list.appendChild(li);
});
}

function add() {
var t = document.getElementById('aTime').value;
var n = document.getElementById('aTitle').value;
if (n === "") { n = "Wecker"; }

var cb = document.querySelectorAll(&#39;.d&#39;);
var sel = [];
for (var i = 0; i &lt; cb.length; i++) {
    if (cb[i].checked) {
        sel.push(parseInt(cb[i].value));
    }
}

if(t === &quot;&quot;) {
    alert(&quot;Zeit fehlt!&quot;);
    return;
}
if(sel.length === 0) {
    alert(&quot;Tage w√§hlen!&quot;);
    return;
}

alarms.push({ t: t, n: n, d: sel });
save();
}

function del(i) {
alarms.splice(i, 1);
save();
}

function save() {
localStorage.setItem('myAlarms', JSON.stringify(alarms));
show();
}

function link() {
var s = encodeURIComponent(JSON.stringify(alarms));
var l = window.location.origin + window.location.pathname + "?setup=" + s;
navigator.clipboard.writeText(l).then(function() { alert("Kopiert!"); });
}

var urlParams = new URLSearchParams(window.location.search);
var p = urlParams.get('setup');
if(p) {
try {
var geladen = JSON.parse(decodeURIComponent(p));
if (Array.isArray(geladen)) {
alarms = geladen;
localStorage.setItem('myAlarms', JSON.stringify(alarms));
window.history.replaceState({}, "", window.location.pathname);
}
} catch(e) {}
}

setInterval(runClock, 1000);
runClock();
show();
</script>

</body>
</html>